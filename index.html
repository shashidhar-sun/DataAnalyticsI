<!DOCTYPE html>
<html>
	<head>
	<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
	<link rel="stylesheet" type="text/css" href="http://meyerweb.com/eric/tools/css/reset/reset.css">
	<link rel="stylesheet" href="http://code.jquery.com/ui/1.9.2/themes/base/jquery-ui.css">
	<link href='http://fonts.googleapis.com/css?family=Rambla:400,700' rel='stylesheet' type='text/css'>
	<style type="text/css">
		html { height: 100% }
		body { height: 100%; margin: 500; padding: 0 }
		#map_canvas {
			position: absolute;
			top: 0;
			width: 100%;
			height: 100%;
			z-index: 0;
		}
		
		a {
			text-decoration: none;
		}
		
		input[type=submit] {
			opacity: 0.75;
		}
		
		#crimeScoreThreshold {
			font-size: 18px;
			overflow: scroll;
			background-color: rgba(255, 255, 255, 0.56);
		}

		#header {
			position: absolute;
			top: 0;
			left: 4%;
			height: 75px;
			background-color: 
			#a9a;
			z-index: 100;
			border-radius: 15px;
		}
		
		#headerShadowBlocker {
			position: absolute;
			bottom: 45px;
			right: -5px;
			height: 42%;
			background-color: #A9A;
			z-index: 500;
			width: 10px;
		}

		#header-back {
			position: absolute;
			top: -15px;
			left: 0;
			height: 45px;
			width: 100%;
			background-color: 
			#a9a;
			z-index: 99;
			border-radius: 15px;
			text-align: right;
		}

		#reset {
			position: absolute;
			top: 0;
			right: 0;
			height: 5%;
			width: 10%;
			background-color: transparent;
			z-index: 100;
			text-align: right;
			padding-top: 5px;
			padding-right: 15px;
		}
		
		.shadow {
			-moz-box-shadow: 3px 3px 4px #000;
			-webkit-box-shadow: 3px 3px 4px #000;
			box-shadow: 3px 3px 4px #000;
			/* For IE 8 */
			-ms-filter: "progid:DXImageTransform.Microsoft.Shadow(Strength=4, Direction=135, Color='#000000')";
			/* For IE 5.5 - 7 */
			filter: progid:DXImageTransform.Microsoft.Shadow(Strength=4, Direction=135, Color='#000000');
		}

		#header h1 {
			font-family: 'Rambla', sans-serif;
			font-size: 48px;
			margin: 15px;
			color: #eee;
		}

		#experimentCrimeScoreLogo {
			font-family: 'Rambla', sans-serif;
			font-size: 24px;
			margin: 15px;
			color: #eee;
		}

		#experiment h2 {
			font-family: 'Rambla', sans-serif;
			font-size: 36px;
			margin: 15px;
			color: #eee;
		}

		#search {
			position: absolute;
			top: 60px;
			z-index: 100;
			background-color: #A9A;
			color: white;
			border-radius: 10px;
			padding: 7px;
			width: 40%;
			left: 30%;
			text-align: center;
			font-family: sans-serif;
			display: none;
			line-height: 24px;
			font-size: 18px;
		}

		.placeInfo-name {
			font-family: sans-serif;
			font-size: 20px;
			padding-bottom: 2px;
		}

		.placeInfo-crimescore {
			font-family: sans-serif;
			font-size: 16px;
			padding-bottom: 10px;
		}

		.placeInfo-crimescore-logo {
			color: #a9a;
			font-weight: bolder;
			font-family: 'Rambla', sans-serif;
			padding-right: 8px;
			font-size: 18px;
		}

		.placeInfo-address {
			font-family: sans-serif;
			font-size: small;
			padding-bottom: 10px;
		}

		.placeInfo-removeLink {
			font-family: sans-serif;
			font-size: small;
			padding-bottom: 10px;
		}

		.placeInfo-telephone {
			font-family: sans-serif;
			font-size: small;
		}

		.placeInfo-website {
			font-family: sans-serif;
			font-size: small;
		}

		.placeInfo-url {
			font-family: sans-serif;
			font-size: small;
		}

		.placeInfo-rating {
			font-family: sans-serif;
			font-size: small;
		}

		.placeInfo-image {
			display: block;
			float: left;
		}

		.placeInfo-image img {
			width: 100px;
		}

		input#searchBox {
			width: 30%;
			line-height: 24px;
			background-color: rgba(255, 255, 255, 0.72);
			font-size: 18px;
			border: 1px;
		}

		td {
			vertical-align: top;
			padding-right: 24px;
		}

		#experiment {
			position: absolute;
			top: 10%;
			right: 30px;
			z-index: 500;
			height: 80%;
			background: #a9a;
			width: 20em;
			border-radius: 15px;
			padding: 15px;
			display: none;
			text-align: center;
			overflow: scroll;
			line-height: 0.4;
		}
		
		.ui-slider-horizontal {
			height: .3em;
		}
		
		.ui-slider .ui-slider-handle {
		position: absolute;
		z-index: 2;
		width: 0.5em;
		height: 0.5em;
		cursor: default;
		}
		
		.ui-slider-horizontal .ui-slider-handle {
		top: -0.1em;
		margin-left: -.6em;
		}

		#sandbox {
			z-index: 501;
			width: 100%;
			height: 100%;
			display: block;
		}

		.plannerSlider {
			width: 90%;
			margin: 5%;
			margin-top: 10px;
			margin-bottom: 10px;
		}
		
		.parmLabel, .parmValue {
			display: inline;
			font-family: sans-serif;
			font-size: 12px;
		}
		
		.parmLabel {
			margin-right: 5px;
		}
	</style>
	<script src="javascript/d3.v2.min.js" type="text/javascript"></script>
	<script src="javascript/jquery-1.8.3.min.js" type="text/javascript"></script>
	<script src="http://code.jquery.com/ui/1.9.2/jquery-ui.js" type="text/javascript"></script>
	<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAK-Z0hFMYhpn0Dztr0lU1WhMvwViPPrwc&libraries=places&sensor=false"></script>
	<script type="text/javascript">
		// Global variables and data structures
		var map;
		var service;
		var i;
		var csPlaces = {}; // the array in which you will score crime scores.
		var mar = new Array();
		var loc;
		var ic;
		var infowindow = new Array();
		var marker = new Array();
		var detailSearchTimers = new Array();
		var demoNumber = 0;
		var idleTime = 0;
		var explorePlace = {};
		var okToUpdate = true;
		var exploreMarker = null;
		var exploring = false;
		
		var csPlace = function(lat, lng) {
			this.latitude = lat;
			this.longitude = lng;
			this.crimescore = -1;
			this.reference = -1;
			this.details = -1;
		}
		
		var processPlanner = function(json) {
			var first = json[0];
			explorePlace = first;
			
			for (elem in first) {
				if (elem != "lat" && elem != "long" && elem != "crime.score") {
					var value = first[elem];
					var mappedID = mapAttributeNames(elem);
					if (mappedID.indexOf("dist") != -1) {
						$("#" + mappedID + "Value").text(value.toFixed(2));
					} else {
						$("#" + mappedID + "Value").text(value);
					}
					$("#" + mappedID + "Slider").slider("value", value);
				}
			}
			
			$("#experimentCrimeScoreLogo").text("CrimeScore: " + first["crime.score"].toFixed(4));
			
			var greenRedInterpolator = d3.interpolateHsl("#00FF00", "#FF0000");
			var scaledCrimeScore = first["crime.score"] / 100;
			var url = 'http://www.googlemapsmarkers.com/v1/' + greenRedInterpolator(scaledCrimeScore).substring(1) +'/';
			var latLng = new google.maps.LatLng(first["lat"], first["long"]);
			
			if (!exploreMarker) {
				exploreMarker = new google.maps.Marker({
					position: latLng,
					map: map,
					icon: url
				});
			} else {
				exploreMarker.setIcon(url);
			}
		}
		
		
		// Main startup routine
		var initialize = function() {
			$("#search").fadeIn(500);

			addSearchBoxListener();
			var mapOptions = {
				center: new google.maps.LatLng(38.89555, -77.0362),
				disableDefaultUI: true,
				zoomControl: true,
				zoomControlOptions: { position: google.maps.ControlPosition.LEFT_CENTER },
				zoom: 11,
				mapTypeId: google.maps.MapTypeId.ROADMAP
			};
			
			map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);
			service = new google.maps.places.PlacesService(map);
			
			$("#resetAll").click(resetAll);
		};
		
		var launchExplore = function() {
			exploring = true;
			
			$("#search").fadeOut(500);
			$("#experiment").fadeIn(500);
			
			$(".plannerSlider").slider();
			$(".plannerSlider").on("slide", handleSliderChange);
			
			$("#experimentPointSelect").click(selectExperimentPoint);
			$("#submitPoint").click(selectSubmitPoint);
			
			resetExplore();
		};
		
		var launchSearch = function() {
			$("#search").fadeIn(500);
			$("#experiment").fadeOut(500);
		}
		
		var resetExplore = function() {
			$(".plannerSlider").each(function(index, element) {
				var sliderMin, sliderMax, sliderStep;
				
				if (index < 16) {
					sliderMin = 0;
					sliderMax = 100;
					sliderStep = 1;
				} else {
					sliderMin = 0;
					sliderMax = 14;
					sliderStep = 0.1;
				}
				$(element).slider("option", "min", sliderMin);
				$(element).slider("option", "max", sliderMax);
				$(element).slider("option", "step", sliderStep);
				$(element).slider("value", 0);
			});
			
			$("#liqcountSlider").slider("option", "max", 350);
			$("#industrialcountSlider").slider("option", "max", 500);
			$("#vacantcountSlider").slider("option", "max", 500);
			
			$(".parmValue").text("0");
			$("#experimentCrimeScoreLogo").text("");
		};
		
		var selectSubmitPoint = function()  {
				for(var i = 1; i<=15;i++ ) {
					explorePlaces.parameters[i+2] = parseInt($("#parm" + i.toString()  + "Value").text());
				}
				
				for(var i = 16; i<=18;i++ ) {
					explorePlaces.parameters[i+2] = parseInt($("#parm" + i.toString()  + "Value").text())/1000;
				}
			//Call backend HERE all data in explorePlaces.parameters
			
			
			console.log(explorePlaces);	
		};
		
		function timerIncrement() {
			idleTime = idleTime + 1;
			if (idleTime > 3) { //  20 secs
				selectSubmitPoint();
			}
		}
		
		var selectExperimentPoint = function() {
			removeMarkers();
			resetExplore();

			google.maps.event.addListenerOnce(map, 'click', function(event) {
				csPlaces = {};
				map.panTo(event.latLng);
				var latitude = event.latLng.lat();
				var longitude = event.latLng.lng();
				// var id = identifierForLatLng(latitude, longitude);
				// csPlaces[id] = new csPlace(latitude, longitude);
				// getCrimeScore(latitude, longitude);
				getExperimentData([latitude, longitude]);
			});
		}
		
		var mapAttributeNames = function(attribute) {
			switch (attribute) {
				case "crime.score":
					return "crimescore";
				case "crimescore":
					return "crime.score";
				case "liq.count":
					return "liqcount";
				case "liqcount":
					return "liq.count";
				case "banks.count":
					return "bankscount";
				case "bankscount":
					return "banks.count";
				case "barber.count":
					return "barbercount";
				case "barbercount":
					return "barber.count";
				case "carlot.count":
					return "carlotcount";
				case "carlotcount":
					return "carlot.count";
				case "dorm.count":
					return "dormcount";
				case "dormcount":
					return "dorm.count";
				case "education.count":
					return "educationcount";
				case "educationcount":
					return "education.count";
				case "embassy.count":
					return "embassycount";
				case "embassycount":
					return "embassy.count";
				case "hospital.count":
					return "hospitalcount";
				case "hospitalcount":
					return "hospital.count";
				case "hotel.count":
					return "hotelcount";
				case "hotelcount":
					return "hotel.count";
				case "industrial.count":
					return "industrialcount";
				case "industrialcount":
					return "industrial.count";
				case "museum.count":
					return "museumcount";
				case "museumcount":
					return "museum.count";
				case "recreation.count":
					return "recreationcount";
				case "recreationcount":
					return "recreation.count";
				case "religious.count":
					return "religiouscount";
				case "religiouscount":
					return "religious.count";
				case "vacant.count":
					return "vacantcount";
				case "vacantcount":
					return "vacant.count";
				case "vehicleservice.count":
					return "vehicleservicecount";
				case "vehicleservicecount":
					return "vehicleservice.count";
				case "military.dist":
					return "militarydist";
				case "militarydist":
					return "military.dist";
				case "police.dist":
					return "policedist";
				case "policedist":
					return "police.dist";
				case "pub.housing.dist":
					return "pubhousingdist";
				case "pubhousingdist":
					return "pub.housing.dist";
				case "university.dist":
					return "universitydist";
				case "universitydist":
					return "university.dist";
			}
		}
		
		var handleSliderChange = function(event, ui) {
			var id = event.target.id.replace("Slider","");
			
			$("#" + id + "Value").text(ui.value);
			var mappedID = mapAttributeNames(id);
			explorePlace[mappedID] = ui.value;
			
			if (okToUpdate) {
				okToUpdate = false;
				setTimeout(function() { okToUpdate = true; }, 1000);
				getExperimentDataWithExistingData();
			}
		};
		
		// Get CrimeScores for an array of lat/lng coordinates
		var getCrimeScores = function(array) {
			coordinates = "coords=" + array.join(",");
			callback = "&callback=?";
			data = coordinates + callback;
			$.getJSON("http://www.crimescore.us:8000/custom/crimescores", data);
		}

		// Get CrimeScore for a single lat/lng
		var getCrimeScore = function(lat, lng) {
			getCrimeScores([lat,lng]);
		}
		
		var getExperimentData = function(array) {
			coordinates = "coords=" + array.join(",");
			callback = "&callback=?";
			data = coordinates + callback;
			$.getJSON("http://www.crimescore.us:8000/custom/planner", data);
		}
		
		var getExperimentDataWithExistingData = function() {
			
			var params = [];
			params.push(explorePlace["lat"]);
			params.push(explorePlace["long"]);
			params.push(explorePlace["liq.count"]);
			params.push(explorePlace["banks.count"]);
			params.push(explorePlace["barber.count"]);
			params.push(explorePlace["carlot.count"]);
			params.push(explorePlace["dorm.count"]);
			params.push(explorePlace["education.count"]);
			params.push(explorePlace["embassy.count"]);
			params.push(explorePlace["hospital.count"]);
			params.push(explorePlace["hotel.count"]);
			params.push(explorePlace["industrial.count"]);
			params.push(explorePlace["museum.count"]);
			params.push(explorePlace["recreation.count"]);
			params.push(explorePlace["religious.count"]);
			params.push(explorePlace["vacant.count"]);
			params.push(explorePlace["vehicleservice.count"]);
			params.push(explorePlace["military.dist"]);
			params.push(explorePlace["police.dist"]);
			params.push(explorePlace["pub.housing.dist"]);
			params.push(explorePlace["university.dist"]);
			coordinates = "coords=" + params.join(",");
			callback = "&callback=?";
			data = coordinates + callback;
			$.getJSON("http://www.crimescore.us:8000/custom/planner", data);
		}
		
		var removeMarkers = function() {
			for (var elem in csPlaces) {
				if (csPlaces[elem].marker) {
					csPlaces[elem].marker.setMap(null);
					delete csPlaces[elem];
				}
			}
		};

		var removeMarker = function(id) {
			if (csPlaces[id]) {
				csPlaces[id].marker.setMap(null);
				delete csPlaces[id];
			}
		}

		// Process returned CrimeScores
		var processCrimeScores = function(data) {
			if (!exploring) {
				
				// Iterate over returned CrimeScores
				for (var i = 0; i < data.places.length ; i++) {
					// Store lat/lng
					var lat = parseFloat(data.places[i].latitude);
					var lng = parseFloat(data.places[i].longitude);

					// Get the id for this lat/lng
					var id = identifierForLatLng(lat, lng);


					// If there wasn't already an entry for this ID, make one
					if (csPlaces[id] === undefined)
						csPlaces[id] = new csPlace(lat, lng);

					var threshold = $("#crimeScoreThreshold").val();

					// Local pointer to csPlaces entry
					var place = csPlaces[id];

					// Add CrimeScore to structure
					place.crimescore = parseFloat(data.places[i].crimescore);

					if (place.crimescore < threshold) {
					
						// Color interpolator
						var greenRedInterpolator = d3.interpolateHsl("#00FF00", "#FF0000");
						var scaledCrimeScore = place.crimescore / 100;


						var url = 'http://www.googlemapsmarkers.com/v1/' + greenRedInterpolator(scaledCrimeScore).substring(1) +'/';
						var latLng = new google.maps.LatLng(place.latitude, place.longitude);
						place.marker = new google.maps.Marker({
							position: latLng,
							map: map,
							icon: url,
							animation: google.maps.Animation.DROP
						});

						var html = ""

						var columns = 0;

						if (place.details != -1) {
							if (place.details.name)
								html += "<div class='placeInfo-name'>" + place.details.name + "</div>";
							if (place.details.formatted_address)
								html += "<div class='placeInfo-address'>" + place.details.formatted_address + "</div>";

							html += "<div class='placeInfo-crimescore'><span class='placeInfo-crimescore-logo'>CrimeScore</span>" + Math.round(place.crimescore) + "</div>";
							html += "<div class='placeInfo-removeLink'><a href=\"javascript:removeMarker('" + identifierForLatLng(place.latitude, place.longitude) + "')\">Remove from Map</a></div>";
							html += "<table><tr>"

							if (place.details && place.details.photos)
								html += "<td><div class='placeInfo-image'><img src='" + place.details.photos[0].raw_reference.fife_url + "' /></div></td>";

							if (place.details.formatted_phone_number) {
								if (columns == 0) {
									html += "<td><table>"
									columns++;
								}
								html += "<tr><td><div class='placeInfo-telephone'>Telephone: " + place.details.formatted_phone_number + "</div></td></tr>";
							}
							if (place.details.rating) {
								if (columns == 0) {
									html += "<td><table>"
									columns++;
								}
								html += "<tr><td><div class='placeInfo-rating'>Rating: " + place.details.rating + "</div></td></tr>";
							}
							if (place.details.url) {
								if (columns == 0) {
									html += "<td><table>"
									columns++;
								}
								html += "<tr><td><div class='placeInfo-url'><a href='" + place.details.url + "'>Google+</a></div></td></tr>";
							}
							if (place.details.website) {
								if (columns == 0) {
									html += "<td><table>"
									columns++;
								}
								html += "<tr><td><div class='placeInfo-website'><a href='" + place.details.website + "'>Website</a></div></td></tr>";
							}

							if (columns > 0) {
								html += "</td></table>"
								columns++;
							}

							html += "</tr></table>";

						} else {
							html += "<div class='placeInfo-crimescore'><span class='placeInfo-crimescore-logo'>CrimeScore</span>" + Math.round(place.crimescore) + "</div>";
							html += "<div class='placeInfo-removeLink'><a href=\"javascript:removeMarker('" + identifierForLatLng(place.latitude, place.longitude) + "')\">Remove from Map</a></div>";
						}

						place.infoWindow = new google.maps.InfoWindow({content: html});
						google.maps.event.addListener(place.marker, 'click', function() {
							place.infoWindow.open(map, place.marker);
						});
					} else {
						delete csPlaces[id];
					}
				}
			}
		};

		// Generate a system-wide identifier for a lat/lng
		var identifierForLatLng = function(latitude, longitude) {
			latitude = latitude.toString();
			latitude = latitude.replace(/-/g, "");
			latitude = latitude.replace(/\./g, "");
			longitude = longitude.toString();
			longitude = longitude.replace(/-/g, "");
			longitude = longitude.replace(/\./g, "");
			return latitude + longitude + "";
		}

		// Add listener to search box
		var addSearchBoxListener = function() {			
			document.getElementById("searchBox").onkeypress = function(e) {
				if (!e) e = window.event;
				if (e.keyCode == '13')
					processSearchBox();
			};
			$("#submitSearch").click(processSearchBox);
		};

		var processSearchBox = function() {
			// Value of text box
			var address = document.getElementById("searchBox").value;

			var request = {
				// Hardcode location to center of Washington, D.C.
				location: new google.maps.LatLng(38.918819,-77.011808),
				// Text box value
				keyword: address,
				// Radius of 8km
				radius: 9000
			};

			// Send request to service
			service.radarSearch(request, processPlaceSearchResult);
		};

		var resetAll = function() {
			for (var i = 0; i < detailSearchTimers.length; i++) {
				clearInterval(detailSearchTimers[i]);
			}
			setTimeout(removeMarkers, 1000);
			launchSearch();
		};

		var processPlaceSearchResult = function(results, status) {
			var i = 0;
			var j = 0;
			while (i < results.length) {
				var toProcess = [];
				for (var k = 0; k < 5; k++) {
					toProcess.push(results[i]);
					i++;
				}

				getPlaceDetailsAfterDelay(toProcess, j * 3000);
				j++;
			}
		};

		var getPlaceDetailsAfterDelay = function(results, delay) {
			var timer = setTimeout(function() {
				for (var i = 0; i < results.length; i++) {
					service.getDetails({reference: results[i].reference}, processPlaceDetailSearchResult);
				}
			}, delay);

			detailSearchTimers.push(timer);
		};

		var processPlaceDetailSearchResult = function(place, status) {
			if (status != google.maps.places.PlacesServiceStatus.OK) {
				console.log(status);
				return;
			}

			if (typeof(place) == "object" && place.geometry) {
				var lat = place.geometry.location.lat();
				var lng = place.geometry.location.lng();
				var id = identifierForLatLng(lat, lng);

				// Create a new csPlace with coordinates and identifier
				csPlaces[id] = new csPlace(lat, lng);
				// csPlaces[id].reference = results[j].reference;
				csPlaces[id].details = place;

				// Fire off a request for a CrimeScore for each coordinate
				getCrimeScore(lat, lng);
			}
		};

		
		// Testing code
		// parseCityPlannerIn("{ 'In': [43.187, 38.674, -77.882,   17,12,11,10,9,8,7,6,5,4,3,2,1, 3, 4, 2.44, 3.33, 3.47] }");
		
		// var testArray = [38.8325192140698,-76.9936390021642,38.90398,-77.05510];
		// getCrimeScores(testArray);
    </script>
	</head>
	<body onload="initialize()">
		<div id="header" class="shadow">
			<h1>CrimeScore</h1>
			<!--
			<div id="modeSelect">
				<h2>Choose a mode: <a href="#">Plan</a> | <a href="#">Explore</a></h2>
			</div>
			<span style="font-weight: bold;">Please enter the query in the search box or click on a point to find the crime score.&nbsp;<label></label></span>
			-->
			<div id="headerShadowBlocker"></div>
		</div>
		<div id="header-back" class="shadow"></div>
		<div id="reset"><input type="submit" value="Reset" id="resetAll"></div>
		<div id="search" class="shadow">
			<input id="searchBox"> with a CrimeScore below 
			<select name="crimeScoreThreshold" id="crimeScoreThreshold">
				<option name="100" selected=true>100</option>
				<option name="99">99</option>
				<option name="98">98</option>
				<option name="97">97</option>
				<option name="96">96</option>
				<option name="95">95</option>
				<option name="94">94</option>
				<option name="93">93</option>
				<option name="92">92</option>
				<option name="91">91</option>
				<option name="90">90</option>
				<option name="89">89</option>
				<option name="88">88</option>
				<option name="87">87</option>
				<option name="86">86</option>
				<option name="85">85</option>
				<option name="84">84</option>
				<option name="83">83</option>
				<option name="82">82</option>
				<option name="81">81</option>
				<option name="80">80</option>
				<option name="79">79</option>
				<option name="78">78</option>
				<option name="77">77</option>
				<option name="76">76</option>
				<option name="75">75</option>
				<option name="74">74</option>
				<option name="73">73</option>
				<option name="72">72</option>
				<option name="71">71</option>
				<option name="69">69</option>
				<option name="68">68</option>
				<option name="67">67</option>
				<option name="66">66</option>
				<option name="65">65</option>
				<option name="64">64</option>
				<option name="63">63</option>
				<option name="62">62</option>
				<option name="61">61</option>
				<option name="60">60</option>
				<option name="59">59</option>
				<option name="58">58</option>
				<option name="57">57</option>
				<option name="56">56</option>
				<option name="55">55</option>
				<option name="54">54</option>
				<option name="53">53</option>
				<option name="52">52</option>
				<option name="51">51</option>
				<option name="50">50</option>
				<option name="49">49</option>
				<option name="48">48</option>
				<option name="47">47</option>
				<option name="46">46</option>
				<option name="45">45</option>
				<option name="44">44</option>
				<option name="43">43</option>
				<option name="42">42</option>
				<option name="41">41</option>
				<option name="40">40</option>
				<option name="39">39</option>
				<option name="38">38</option>
				<option name="37">37</option>
				<option name="36">36</option>
				<option name="35">35</option>
				<option name="34">34</option>
				<option name="33">33</option>
				<option name="32">32</option>
				<option name="31">31</option>
				<option name="30">30</option>
				<option name="29">29</option>
				<option name="28">28</option>
				<option name="27">27</option>
				<option name="26">26</option>
				<option name="25">25</option>
				<option name="24">24</option>
				<option name="23">23</option>
				<option name="22">22</option>
				<option name="21">21</option>
				<option name="20">20</option>
				<option name="19">19</option>
				<option name="18">18</option>
				<option name="17">17</option>
				<option name="16">16</option>
				<option name="15">15</option>
				<option name="14">14</option>
				<option name="13">13</option>
				<option name="12">12</option>
				<option name="11">11</option>
				<option name="10">10</option>
				<option name="9">9</option>
				<option name="8">8</option>
				<option name="7">7</option>
				<option name="6">6</option>
				<option name="5">5</option>
				<option name="4">4</option>
				<option name="2">2</option>
				<option name="1">1</option>
			</select>
			<input type="submit" id="submitSearch" value="Go" /><br />
			(or <a href="javascript:launchExplore()" >Experiment</a>!)
		</div>
		<!-- <div id="planner"></div> -->
		<div id="experiment" class="shadow">
			<h2>Experiment Tool</h2>
			<input type="submit" id="experimentPointSelect" value="Select a new point">
			<div id="sandbox">
				<div id="experimentCrimeScoreLogo"></div>
				<div id="experimentSliders">
				
					<div class="parmLabel">Liquor Store Count</div>
					<div class="parmValue" id="liqcountValue">0</div>
					<div id="liqcountSlider" class="plannerSlider"></div>
				
					<div class="parmLabel">Bank Count</div>
					<div class="parmValue" id="bankscountValue">0</div>
					<div id="bankscountSlider" class="plannerSlider"></div>
				
					<div class="parmLabel">Barber Shop Count</div>
					<div class="parmValue" id="barbercountValue">0</div>
					<div id="barbercountSlider" class="plannerSlider"></div>
				
					<div class="parmLabel">Car Lot Count</div>
					<div class="parmValue" id="carlotcountValue">0</div>
					<div id="carlotcountSlider" class="plannerSlider"></div>
				
					<div class="parmLabel">Dorm Count</div>
					<div class="parmValue" id="dormcountValue">0</div>
					<div id="dormcountSlider" class="plannerSlider"></div>
				
					<div class="parmLabel">School Count</div>
					<div class="parmValue" id="educationcountValue">0</div>
					<div id="educationcountSlider" class="plannerSlider"></div>
				
					<div class="parmLabel">Embassy Count</div>
					<div class="parmValue" id="embassycountValue">0</div>
					<div id="embassycountSlider" class="plannerSlider"></div>
				
					<div class="parmLabel">Hospital Count</div>
					<div class="parmValue" id="hospitalcountValue">0</div>
					<div id="hospitalcountSlider" class="plannerSlider"></div>
				
					<div class="parmLabel">Hotel Count</div>
					<div class="parmValue" id="hotelcountValue">0</div>
					<div id="hotelcountSlider" class="plannerSlider"></div>
				
					<div class="parmLabel">Industrial Area Count</div>
					<div class="parmValue" id="industrialcountValue">0</div>
					<div id="industrialcountSlider" class="plannerSlider"></div>
				
					<div class="parmLabel">Museum Count</div>
					<div class="parmValue" id="museumcountValue">0</div>
					<div id="museumcountSlider" class="plannerSlider"></div>
				
					<div class="parmLabel">Recreation Area Count</div>
					<div class="parmValue" id="recreationcountValue">0</div>
					<div id="recreationcountSlider" class="plannerSlider"></div>
				
					<div class="parmLabel">Religious Establishment Count</div>
					<div class="parmValue" id="religiouscountValue">0</div>
					<div id="religiouscountSlider" class="plannerSlider"></div>
				
					<div class="parmLabel">Vacant Lot Count</div>
					<div class="parmValue" id="vacantcountValue">0</div>
					<div id="vacantcountSlider" class="plannerSlider"></div>
				
					<div class="parmLabel">Vehicle Repair Shop Count</div>
					<div class="parmValue" id="vehicleservicecountValue">0</div>
					<div id="vehicleservicecountSlider" class="plannerSlider"></div>
				
					<div class="parmLabel">Distance to Military Installation (km)</div>
					<div class="parmValue" id="militarydistValue">0</div>
					<div id="militarydistSlider" class="plannerSlider"></div>
				
					<div class="parmLabel">Distance to Police Station (km)</div>
					<div class="parmValue" id="policedistValue">0</div>
					<div id="policedistSlider" class="plannerSlider"></div>
				
					<div class="parmLabel">Distance to Public Housing (km)</div>
					<div class="parmValue" id="pubhousingdistValue">0</div>
					<div id="pubhousingdistSlider" class="plannerSlider"></div>
				
					<div class="parmLabel">Distance to University (km)</div>
					<div class="parmValue" id="universitydistValue">0</div>
					<div id="universitydistSlider" class="plannerSlider"></div>
				</div>
			</div>
		</div>
		<div id="map_canvas"></div>
	</body>
</html>